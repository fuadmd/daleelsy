
import React, { useState } from 'react';
import { Job, Language } from '../types';
import { translations } from '../translations';
import { generateJobSummary } from '../services/gemini';

interface JobCardProps {
  job: Job;
  lang: Language;
  onClick: () => void;
}

const JobCard: React.FC<JobCardProps> = ({ job, lang, onClick }) => {
  const t = translations[lang];
  const [aiSummary, setAiSummary] = useState<string | null>(null);
  const [loadingAi, setLoadingAi] = useState(false);

  const handleAiSummary = async (e: React.MouseEvent) => {
    e.stopPropagation();
    if (aiSummary) return;
    setLoadingAi(true);
    const summary = await generateJobSummary(job.description, lang);
    setAiSummary(summary);
    setLoadingAi(false);
  };

  return (
    <div 
      onClick={onClick}
      className="bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm border dark:border-gray-700 rounded-2xl p-6 hover:shadow-xl transition-all group cursor-pointer border-l-4 border-l-transparent hover:border-l-secondary"
    >
      <div className="flex flex-col md:flex-row justify-between gap-4">
        <div className="flex gap-4">
          <div className="w-16 h-16 bg-primary/10 dark:bg-primary/20 rounded-full flex items-center justify-center text-primary dark:text-primary shrink-0 transition-all group-hover:bg-secondary/10 group-hover:text-secondary overflow-hidden border dark:border-gray-700">
            {job.companyLogo ? (
              <img 
                src={job.companyLogo} 
                alt={job.company} 
                className="w-full h-full object-contain p-1"
                onError={(e) => {
                  (e.target as HTMLImageElement).style.display = 'none';
                  (e.target as HTMLImageElement).parentElement!.innerHTML = '<i class="fas fa-building text-2xl"></i>';
                }}
              />
            ) : (
              <i className="fas fa-building text-2xl"></i>
            )}
          </div>
          <div>
            <h3 className="text-xl font-bold group-hover:text-secondary transition-all text-title-contrast">{job.title}</h3>
            <div className="flex flex-wrap gap-x-4 gap-y-1 mt-1 text-sm text-gray-500 dark:text-gray-400">
              <span className="flex items-center gap-1">
                <i className="fas fa-city text-xs text-secondary/70"></i> {job.company}
              </span>
              <span className="flex items-center gap-1">
                <i className="fas fa-map-marker-alt text-xs text-secondary/70"></i> {t[job.region as keyof typeof t]} {job.subRegion && `(${job.subRegion})`}
              </span>
              <span className="flex items-center gap-1">
                <i className="fas fa-briefcase text-xs text-secondary/70"></i> {t[job.specialty.toLowerCase() as keyof typeof t]}
              </span>
            </div>
          </div>
        </div>
        <div className="flex flex-row md:flex-col items-center md:items-end justify-between md:justify-start gap-2">
          <span className="bg-green-100 dark:bg-green-900/40 text-green-700 dark:text-green-300 px-3 py-1 rounded-full text-xs font-bold uppercase">
            {t.active}
          </span>
          <span className="text-xs text-gray-400 dark:text-gray-500 font-medium">{job.postedAt}</span>
        </div>
      </div>

      <div className="mt-4 text-gray-600 dark:text-gray-300 text-sm line-clamp-2 leading-relaxed">
        {job.description}
      </div>

      {aiSummary && (
        <div className="mt-4 p-4 bg-secondary/5 dark:bg-secondary/10 border border-secondary/20 dark:border-secondary/30 rounded-xl text-sm italic text-gray-800 dark:text-gray-200 animate-fade-in">
          <div className="flex items-center gap-2 mb-1 font-bold text-secondary">
            <i className="fas fa-robot"></i> AI Summary:
          </div>
          {aiSummary}
        </div>
      )}

      <div className="mt-6 flex flex-wrap gap-3 items-center justify-between border-t dark:border-gray-700 pt-4">
        <div className="flex gap-2">
          <button 
            onClick={handleAiSummary}
            disabled={loadingAi}
            className="text-primary dark:text-primary hover:bg-primary/10 dark:hover:bg-primary/20 hover:text-secondary px-3 py-2 rounded-lg text-sm flex items-center gap-2 font-bold transition-all"
          >
            {loadingAi ? <i className="fas fa-spinner fa-spin"></i> : <i className="fas fa-magic"></i>}
            {lang === 'ar' ? 'ملخص ذكي' : 'Smart Summary'}
          </button>
        </div>
        <button 
          className="bg-primary text-white px-8 py-2 rounded-xl hover:bg-secondary font-bold transition-all shadow-md transform active:scale-95"
          onClick={(e) => {
            e.stopPropagation();
            onClick();
          }}
        >
          {lang === 'ar' ? 'عرض التفاصيل' : 'View Details'}
        </button>
      </div>
    </div>
  );
};

export default JobCard;


import React from 'react';
import { Job, Language } from '../types';
import { translations } from '../translations';

interface JobDetailModalProps {
  job: Job;
  lang: Language;
  onClose: () => void;
}

const JobDetailModal: React.FC<JobDetailModalProps> = ({ job, lang, onClose }) => {
  const t = translations[lang];

  return (
    <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm animate-fade-in">
      <div 
        className="bg-white dark:bg-gray-800 w-full max-w-2xl rounded-3xl shadow-2xl overflow-hidden animate-zoom-in transition-colors duration-300"
        onClick={(e) => e.stopPropagation()}
      >
        <div className="relative h-40 bg-primary overflow-hidden transition-colors duration-300">
          <div className="absolute top-6 right-6 z-10">
            <button 
              onClick={onClose}
              className="w-12 h-12 bg-white/20 hover:bg-white/40 text-white rounded-full flex items-center justify-center backdrop-blur-md transition-all border border-white/10"
            >
              <i className="fas fa-times text-xl"></i>
            </button>
          </div>
          <div className="absolute bottom-[-40px] left-10 w-28 h-28 bg-white dark:bg-gray-700 rounded-full shadow-2xl flex items-center justify-center text-primary dark:text-primary text-4xl border-4 border-gray-50 dark:border-gray-800 transition-all overflow-hidden">
            {job.companyLogo ? (
              <img src={job.companyLogo} alt={job.company} className="w-full h-full object-contain p-2" />
            ) : (
              <i className="fas fa-building"></i>
            )}
          </div>
          <div className="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent"></div>
        </div>

        <div className="px-10 pt-16 pb-10 space-y-8">
          <div className="space-y-2">
            <h2 className="text-4xl font-black text-gray-900 dark:text-gray-50">{job.title}</h2>
            <div className="flex items-center gap-2">
              <p className="text-primary dark:text-primary font-extrabold text-xl transition-colors">{job.company}</p>
              <span className="w-1 h-1 bg-gray-300 rounded-full"></span>
              <span className="text-green-600 dark:text-green-400 font-bold text-sm uppercase">{t.active}</span>
            </div>
            <div className="flex flex-wrap gap-5 text-sm font-medium text-gray-500 dark:text-gray-300 pt-3">
              <span className="flex items-center gap-2 px-3 py-1 bg-gray-50 dark:bg-gray-700 rounded-full">
                <i className="fas fa-map-marker-alt text-primary"></i>
                {t[job.region as keyof typeof t]} {job.subRegion && `(${job.subRegion})`}
              </span>
              <span className="flex items-center gap-2 px-3 py-1 bg-gray-50 dark:bg-gray-700 rounded-full">
                <i className="fas fa-briefcase text-primary"></i>
                {t[job.specialty.toLowerCase() as keyof typeof t]}
              </span>
              <span className="flex items-center gap-2 px-3 py-1 bg-gray-50 dark:bg-gray-700 rounded-full">
                <i className="fas fa-calendar-alt text-primary"></i>
                {job.postedAt}
              </span>
            </div>
          </div>

          <div className="border-t dark:border-gray-700 pt-8">
            <h3 className="text-2xl font-black mb-4 dark:text-white flex items-center gap-2">
              <i className="fas fa-align-left text-primary"></i>
              {lang === 'ar' ? 'تفاصيل الوظيفة' : 'Job Details'}
            </h3>
            <p className="text-gray-700 dark:text-gray-200 leading-relaxed whitespace-pre-wrap text-lg">
              {job.description}
            </p>
          </div>

          {job.attachments && job.attachments.length > 0 && (
            <div className="border-t dark:border-gray-700 pt-8">
              <h3 className="text-xl font-bold mb-4 dark:text-white flex items-center gap-2">
                <i className="fas fa-paperclip text-primary"></i>
                {lang === 'ar' ? 'المرفقات والوثائق' : 'Attachments & Documents'}
              </h3>
              <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                {job.attachments.map((url, idx) => (
                  <a 
                    key={idx} 
                    href={url} 
                    target="_blank" 
                    rel="noreferrer"
                    className="flex items-center justify-between gap-3 px-5 py-4 bg-primary/5 dark:bg-gray-700 hover:bg-primary/10 dark:hover:bg-gray-600 rounded-2xl border border-primary/10 dark:border-gray-600 group transition-all"
                  >
                    <div className="flex items-center gap-3">
                      <div className="w-10 h-10 bg-white dark:bg-gray-800 rounded-xl flex items-center justify-center text-primary dark:text-primary shadow-sm">
                        <i className="fas fa-file-pdf"></i>
                      </div>
                      <span className="font-bold text-gray-800 dark:text-gray-200">{lang === 'ar' ? `مرفق رقم ${idx + 1}` : `Document ${idx + 1}`}</span>
                    </div>
                    <i className="fas fa-download text-gray-400 group-hover:text-primary transition-colors"></i>
                  </a>
                ))}
              </div>
            </div>
          )}

          <div className="pt-10 border-t dark:border-gray-700 flex flex-col sm:flex-row gap-4">
            {job.externalApplyUrl ? (
              <a 
                href={job.externalApplyUrl} 
                target="_blank" 
                rel="noreferrer"
                className="flex-grow bg-primary text-white text-center py-5 rounded-2xl font-black text-xl shadow-xl hover:opacity-90 transform hover:scale-[1.02] transition-all flex items-center justify-center gap-3"
              >
                <i className="fas fa-paper-plane"></i>
                {t.applyNow}
              </a>
            ) : (
              <button className="flex-grow bg-primary text-white py-5 rounded-2xl font-black text-xl shadow-xl hover:opacity-90 transform hover:scale-[1.02] transition-all">
                {t.applyNow}
              </button>
            )}
            <button 
              className="px-10 py-5 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-2xl font-black text-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-all shadow-sm"
              onClick={onClose}
            >
              {lang === 'ar' ? 'إغلاق' : 'Close'}
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};

export default JobDetailModal;


import React from 'react';
import { User, UserRole, Language, Theme } from '../types';
import { translations } from '../translations';

interface NavbarProps {
  lang: Language;
  setLang: (l: Language) => void;
  currentUser: User | null;
  onLogout: () => void;
  setCurrentPage: (p: any) => void;
  currentPage: string;
  theme: Theme;
  toggleTheme: () => void;
}

const Navbar: React.FC<NavbarProps> = ({ lang, setLang, currentUser, onLogout, setCurrentPage, currentPage, theme, toggleTheme }) => {
  const t = translations[lang];

  return (
    <nav className="bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-50 border-b dark:border-gray-700 transition-colors duration-300">
      <div className="container mx-auto px-4 py-4 flex items-center justify-between">
        <div 
          className="text-2xl font-bold text-primary cursor-pointer flex items-center gap-2"
          onClick={() => setCurrentPage('home')}
        >
          <i className="fas fa-briefcase"></i>
          <span>{t.appName}</span>
        </div>

        <div className="hidden md:flex items-center gap-6">
          <button 
            onClick={() => setCurrentPage('home')}
            className={`${currentPage === 'home' ? 'text-primary font-bold' : 'text-gray-600 dark:text-gray-300'} hover:text-secondary transition-all`}
          >
            {t.home}
          </button>
          
          {(currentUser?.role === UserRole.SUPER_ADMIN || currentUser?.role === UserRole.LIMITED_ADMIN) && (
            <button 
              onClick={() => setCurrentPage('admin')}
              className={`${currentPage === 'admin' ? 'text-primary font-bold' : 'text-gray-600 dark:text-gray-300'} hover:text-secondary`}
            >
              {t.adminPanel}
            </button>
          )}

          {currentUser?.role === UserRole.EMPLOYER && (
            <button 
              onClick={() => setCurrentPage('employer')}
              className={`${currentPage === 'employer' ? 'text-primary font-bold' : 'text-gray-600 dark:text-gray-300'} hover:text-secondary`}
            >
              {t.employerPanel}
            </button>
          )}

          {currentUser && (
            <button 
              onClick={() => setCurrentPage('user')}
              className={`${currentPage === 'user' ? 'text-primary font-bold' : 'text-gray-600 dark:text-gray-300'} hover:text-secondary`}
            >
              {t.profile}
            </button>
          )}
        </div>

        <div className="flex items-center gap-3">
          <button 
            onClick={toggleTheme}
            className="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-300 border dark:border-gray-600 transition-all"
            title={theme === 'light' ? t.darkMode : t.lightMode}
          >
            <i className={`fas ${theme === 'light' ? 'fa-moon' : 'fa-sun'}`}></i>
          </button>

          <button 
            onClick={() => setLang(lang === 'ar' ? 'en' : 'ar')}
            className="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2 text-sm font-medium border dark:border-gray-600 dark:text-gray-300"
          >
            <i className="fas fa-globe"></i>
            {lang === 'ar' ? 'EN' : 'ع'}
          </button>

          {!currentUser ? (
            <button 
              onClick={() => setCurrentPage('login')}
              className="bg-primary text-white px-6 py-2 rounded-lg hover:opacity-90 transition-all shadow-md font-bold"
            >
              {t.login}
            </button>
          ) : (
            <div className="flex items-center gap-3">
              <div className="flex flex-col items-end">
                <span className="text-sm font-bold dark:text-white">{currentUser.name}</span>
                <span className="text-xs text-gray-500 dark:text-gray-400">{t[currentUser.role.toLowerCase() as keyof typeof t]}</span>
              </div>
              <button 
                onClick={onLogout}
                className="text-red-500 hover:text-red-600 p-2"
              >
                <i className="fas fa-sign-out-alt"></i>
              </button>
            </div>
          )}
        </div>
      </div>
    </nav>
  );
};

export default Navbar;
